/home-mscluster/sjumoorty2/anaconda3/envs/atari/lib/python3.10/site-packages/jax/_src/deprecations.py:51: DeprecationWarning: jax.interpreters.pxla.ShardedDeviceArray is deprecated. Use jax.Array.
  warnings.warn(message, DeprecationWarning)
/home-mscluster/sjumoorty2/anaconda3/envs/atari/lib/python3.10/site-packages/jax/_src/deprecations.py:51: DeprecationWarning: jax.numpy.DeviceArray is deprecated. Use jax.Array.
  warnings.warn(message, DeprecationWarning)
/home-mscluster/sjumoorty2/anaconda3/envs/atari/lib/python3.10/site-packages/torch/utils/tensorboard/__init__.py:4: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
  if not hasattr(tensorboard, "__version__") or LooseVersion(
/home-mscluster/sjumoorty2/anaconda3/envs/atari/lib/python3.10/site-packages/pkg_resources/__init__.py:121: DeprecationWarning: pkg_resources is deprecated as an API
  warnings.warn("pkg_resources is deprecated as an API", DeprecationWarning)
/home-mscluster/sjumoorty2/anaconda3/envs/atari/lib/python3.10/site-packages/pkg_resources/__init__.py:2870: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('google')`.
Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
  declare_namespace(pkg)
/home-mscluster/sjumoorty2/anaconda3/envs/atari/lib/python3.10/site-packages/pkg_resources/__init__.py:2870: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('mpl_toolkits')`.
Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
  declare_namespace(pkg)
wandb: Currently logged in as: sayfullah-jumoorty (sayf). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.17.1 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.13.11
wandb: Run data is saved locally in /home-mscluster/sjumoorty2/cleanrl/down_sampling_exp/wandb/run-20240611_190646-3jg5pta7
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run ALE/Breakout-v5__downsampling-val-32x32__1__1718125603
wandb: ‚≠êÔ∏è View project at https://wandb.ai/sayf/atari
wandb: üöÄ View run at https://wandb.ai/sayf/atari/runs/3jg5pta7
/home-mscluster/sjumoorty2/anaconda3/envs/atari/lib/python3.10/site-packages/wandb/sdk/lib/import_hooks.py:243: DeprecationWarning: Deprecated since Python 3.4 and slated for removal in Python 3.12; use importlib.util.find_spec() instead
  loader = importlib.find_loader(fullname, path)
2024-06-11 19:06:50.827554: E external/xla/xla/stream_executor/cuda/cuda_driver.cc:268] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
No GPU/TPU found, falling back to CPU. (Set TF_CPP_MIN_LOG_LEVEL=0 and rerun for more info.)
A.L.E: Arcade Learning Environment (version 0.8.1+53f58b7)
[Powered by Stella]
/home-mscluster/sjumoorty2/anaconda3/envs/atari/lib/python3.10/site-packages/gymnasium/utils/passive_env_checker.py:364: UserWarning: [33mWARN: No render fps was declared in the environment (env.metadata['render_fps'] is None or not defined), rendering may occur at inconsistent fps.[0m
  logger.warn(
Initial observation shape: (1, 4, 32, 32)
Shape after flattening: (1, 0)
Traceback (most recent call last):
  File "/home-mscluster/sjumoorty2/cleanrl/cleanrl/dqn_atari_jax.py", line 163, in <module>
    params=q_network.init(q_key, obs),
  File "/home-mscluster/sjumoorty2/anaconda3/envs/atari/lib/python3.10/site-packages/jax/_src/traceback_util.py", line 166, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home-mscluster/sjumoorty2/anaconda3/envs/atari/lib/python3.10/site-packages/flax/linen/module.py", line 1621, in init
    _, v_out = self.init_with_output(
  File "/home-mscluster/sjumoorty2/anaconda3/envs/atari/lib/python3.10/site-packages/jax/_src/traceback_util.py", line 166, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home-mscluster/sjumoorty2/anaconda3/envs/atari/lib/python3.10/site-packages/flax/linen/module.py", line 1526, in init_with_output
    return init_with_output(
  File "/home-mscluster/sjumoorty2/anaconda3/envs/atari/lib/python3.10/site-packages/flax/core/scope.py", line 965, in wrapper
    return apply(fn, mutable=mutable, flags=init_flags)({}, *args, rngs=rngs,
  File "/home-mscluster/sjumoorty2/anaconda3/envs/atari/lib/python3.10/site-packages/flax/core/scope.py", line 933, in wrapper
    y = fn(root, *args, **kwargs)
  File "/home-mscluster/sjumoorty2/anaconda3/envs/atari/lib/python3.10/site-packages/flax/linen/module.py", line 2102, in scope_fn
    return fn(module.clone(parent=scope), *args, **kwargs)
  File "/home-mscluster/sjumoorty2/anaconda3/envs/atari/lib/python3.10/site-packages/flax/linen/module.py", line 427, in wrapped_module_method
    return self._call_wrapped_method(fun, args, kwargs)
  File "/home-mscluster/sjumoorty2/anaconda3/envs/atari/lib/python3.10/site-packages/flax/linen/module.py", line 845, in _call_wrapped_method
    y = fun(self, *args, **kwargs)
  File "/home-mscluster/sjumoorty2/cleanrl/cleanrl/dqn_atari_jax.py", line 99, in __call__
    x = nn.Dense(512)(x)
  File "/home-mscluster/sjumoorty2/anaconda3/envs/atari/lib/python3.10/site-packages/flax/linen/module.py", line 427, in wrapped_module_method
    return self._call_wrapped_method(fun, args, kwargs)
  File "/home-mscluster/sjumoorty2/anaconda3/envs/atari/lib/python3.10/site-packages/flax/linen/module.py", line 845, in _call_wrapped_method
    y = fun(self, *args, **kwargs)
  File "/home-mscluster/sjumoorty2/anaconda3/envs/atari/lib/python3.10/site-packages/flax/linen/linear.py", line 196, in __call__
    kernel = self.param('kernel',
  File "/home-mscluster/sjumoorty2/anaconda3/envs/atari/lib/python3.10/site-packages/flax/linen/module.py", line 1222, in param
    v = self.scope.param(name, init_fn, *init_args, unbox=unbox)
  File "/home-mscluster/sjumoorty2/anaconda3/envs/atari/lib/python3.10/site-packages/flax/core/scope.py", line 842, in param
    value = init_fn(self.make_rng('params'), *init_args)
  File "/home-mscluster/sjumoorty2/anaconda3/envs/atari/lib/python3.10/site-packages/jax/_src/nn/initializers.py", line 268, in init
    fan_in, fan_out = _compute_fans(named_shape, in_axis, out_axis, batch_axis)
  File "/home-mscluster/sjumoorty2/anaconda3/envs/atari/lib/python3.10/site-packages/jax/_src/nn/initializers.py", line 175, in _compute_fans
    receptive_field_size = shape.total / in_size / out_size / batch_size
jax._src.traceback_util.UnfilteredStackTrace: ZeroDivisionError: division by zero

The stack trace below excludes JAX-internal frames.
The preceding is the original exception that occurred, unmodified.

--------------------

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home-mscluster/sjumoorty2/cleanrl/cleanrl/dqn_atari_jax.py", line 163, in <module>
    params=q_network.init(q_key, obs),
  File "/home-mscluster/sjumoorty2/cleanrl/cleanrl/dqn_atari_jax.py", line 99, in __call__
    x = nn.Dense(512)(x)
  File "/home-mscluster/sjumoorty2/anaconda3/envs/atari/lib/python3.10/site-packages/flax/linen/linear.py", line 196, in __call__
    kernel = self.param('kernel',
  File "/home-mscluster/sjumoorty2/anaconda3/envs/atari/lib/python3.10/site-packages/jax/_src/nn/initializers.py", line 268, in init
    fan_in, fan_out = _compute_fans(named_shape, in_axis, out_axis, batch_axis)
  File "/home-mscluster/sjumoorty2/anaconda3/envs/atari/lib/python3.10/site-packages/jax/_src/nn/initializers.py", line 175, in _compute_fans
    receptive_field_size = shape.total / in_size / out_size / batch_size
ZeroDivisionError: division by zero
wandb: Waiting for W&B process to finish... (failed 1). Press Control-C to abort syncing.
wandb: 
wandb: Run history:
wandb: global_step ‚ñÅ
wandb: 
wandb: Run summary:
wandb: global_step 0
wandb: 
wandb: üöÄ View run ALE/Breakout-v5__downsampling-val-32x32__1__1718125603 at: https://wandb.ai/sayf/atari/runs/3jg5pta7
wandb: Synced 7 W&B file(s), 0 media file(s), 3 artifact file(s) and 2 other file(s)
wandb: Find logs at: ./wandb/run-20240611_190646-3jg5pta7/logs
srun: error: mscluster54: task 0: Exited with exit code 1
